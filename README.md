# CSV转换ics工具

## 项目简介
CSV转换ics工具是一个用于将CSV格式的日程数据转换为ICS日历格式的桌面应用程序。该工具支持高分辨率屏幕适配、灵活的字段映射、详细的错误提示和标准的ICS文件生成，完全通过AiPy开发完成。

## 功能特点
1. **高分辨率屏幕适配**：自动识别系统DPI设置，调整界面缩放比例
2. **灵活的字段映射**：支持CSV字段与ICS字段的自定义映射
3. **多编码支持**：自动识别CSV文件编码（UTF-8、GBK等）
4. **标准ICS生成**：遵循RFC5545标准，包含时区和提醒设置
5. **友好的用户界面**：响应式布局，支持窗口大小调整
6. **详细错误提示**：提供清晰的错误信息和解决方案
7. **进度显示**：实时显示转换进度和状态

## 安装方法
1. 直接下载发布版中的`CSV转换ics工具.exe`文件
2. 无需安装，双击即可运行

## 使用说明
1. **选择CSV文件**：点击"浏览"按钮选择包含日程数据的CSV文件
2. **字段映射**：工具自动识别CSV字段，用户可自定义映射关系
3. **选择输出目录**：指定ICS文件的保存位置
4. **开始转换**：点击"开始转换"按钮，等待进度条完成
5. **查看结果**：转换完成后，工具会显示生成的ICS文件路径

## 功能实现细节

### 1. 高分辨率适配实现
- 使用Windows API设置DPI感知：`SetProcessDpiAwareness`
- 动态调整界面缩放比例：`tk.scaling`
- 响应式布局设计：根据窗口大小自动调整控件位置
- 支持多种屏幕分辨率：从1080p到4K+

### 2. CSV解析与字段映射
- 自动识别CSV编码：支持UTF-8、UTF-8-SIG、GBK、GB2312等
- 智能表头识别：自动检测包含"日程主题"的行作为表头
- 灵活字段映射：支持5个核心ICS字段的自定义映射
- 数据验证：检查必填字段和数据格式

### 3. ICS文件生成规则
- 遵循RFC5545标准：正确的ICS文件结构
- 时区支持：包含完整的VTIMEZONE区块
- 提醒设置：默认提前15分钟提醒（VALARM）
- 字符编码：所有文本字段使用UTF-8编码
- 唯一标识符：每个事件生成唯一UID

### 4. 界面设计与用户体验
- 使用Tkinter构建现代GUI界面
- 响应式布局：控件自动适应窗口大小
- 进度显示：实时更新转换进度
- 错误提示：使用颜色区分不同类型的提示信息
- 操作反馈：按钮状态变化提示操作状态

### 5. 错误处理机制
- 文件操作错误处理：文件不存在、权限问题等
- 数据格式验证：检查日期时间格式有效性
- 网络错误处理：（用于图标下载等网络操作）
- 资源清理：确保临时文件和内存资源正确释放

## 开发致谢
本工具完全通过AiPy（Advanced Intelligence Python）开发完成，感谢AiPy提供的强大开发能力和支持。

## 许可证
本项目采用MIT许可证，详情请参见LICENSE文件。
